name: unit test runner

# Uruchamia workflow przy push i pull request na każdą gałąź
on:
  push:
    branches: [temp]

jobs:
  build-and-test:
    # GitHub-hosted runner w chmurze
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ Pobranie kodu z repo
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2️⃣ Ustawienie Javy 11
      - name: Set up Java 11
        uses: actions/setup-java@v3
        with:
          distribution: temurin
          java-version: 11
          cache: maven  # cache dla zależności Maven

      # 3️⃣ Sprawdzenie wersji Javy
      - name: Check Java version
        run: java -version

      # 4️⃣ Instalacja zależności i budowanie projektu
      - name: Build with Maven
        run: mvn clean compile

      # 5️⃣ Uruchomienie testów jednostkowych
      - name: Run unit tests
        run: mvn test

      # 6️⃣ Wyświetlenie raportów testów (opcjonalnie)
      - name: Show test reports
        run: |
          if [ -d target/surefire-reports ]; then
            cat target/surefire-reports/*.txt
          else
            echo "No test reports found"
          fi
